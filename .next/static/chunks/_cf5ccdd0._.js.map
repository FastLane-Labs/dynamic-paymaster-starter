{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///Users/marshabl/Dropbox/CS/typescript_practice/dynamic-paymaster-starter/lib/fastlane/user.ts"],"sourcesContent":["import { createPublicClient, createWalletClient, Hex, http } from \"viem\";\nimport {\n  CHAIN,\n  RPC_URL,\n  PAYMASTER_URL,\n  PRIVATE_KEY,\n  SHBUNDLER_URL,\n  SPONSOR_WALLET_PRIVATE_KEY, \n} from \"./constants\";\nimport { toSafeSmartAccount } from \"permissionless/accounts\";\nimport { createBundlerClient, entryPoint07Address } from \"viem/account-abstraction\";\nimport { createPaymasterClient } from \"viem/account-abstraction\";\nimport { privateKeyToAccount } from \"viem/accounts\";\nimport { createSmartAccountClient } from \"permissionless/clients\";\n\n\n// EOA\nconst EOA = privateKeyToAccount(PRIVATE_KEY);\n\n// user client\nconst userClient = createWalletClient({\n  chain: CHAIN,\n  transport: http(RPC_URL),\n  account: EOA,\n});\n\n// public client\nconst publicClient = createPublicClient({\n  transport: http(RPC_URL),\n  chain: CHAIN,\n});\n\n// paymaster client\nconst paymasterClient = createPaymasterClient({\n  transport: http(PAYMASTER_URL),\n});\n\n// sponsor account\nconst sponsorEOA = privateKeyToAccount(SPONSOR_WALLET_PRIVATE_KEY as Hex)\n\n// sponsor wallet\nconst sponsorClient = createWalletClient({\n  account: sponsorEOA,\n  chain: CHAIN,\n  transport: http(RPC_URL)\n})\n\n// smart wallet\nconst smartAccount = await toSafeSmartAccount({\n  client: publicClient,\n  entryPoint: {\n    address: entryPoint07Address,\n    version: \"0.7\",\n  },\n  owners: [EOA],\n  version: \"1.4.1\"\n});\n\nconst shBundler = createBundlerClient({\n  transport: http(SHBUNDLER_URL),\n  name: \"shBundler\",\n  account: smartAccount,\n  client: publicClient,\n  chain: CHAIN,\n  paymaster: paymasterClient,\n  // paymasterContext: {\n  //   mode: \"sponsor\",\n  //   address: sponsorEOA.address,\n  // },\n})\n\nconst smartAccountClient = createSmartAccountClient({\n  account: smartAccount,\n  client: publicClient,\n  chain: CHAIN,\n  bundlerTransport: http(SHBUNDLER_URL),\n});\n\n\nexport { \n  userClient, \n  publicClient, \n  smartAccount, \n  paymasterClient, \n  sponsorClient, \n  shBundler,\n  sponsorEOA,\n  smartAccountClient,\n};\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AACA;AAQA;AACA;AAAA;AACA;AACA;AACA;;;;;;;;AAGA,MAAM;AACN,MAAM,MAAM,CAAA,GAAA,kKAAA,CAAA,sBAAmB,AAAD,EAAE,+HAAA,CAAA,cAAW;;AAE3C,cAAc;AACd,MAAM,aAAa,CAAA,GAAA,gKAAA,CAAA,qBAAkB,AAAD,EAAE;IACpC,OAAO,+HAAA,CAAA,QAAK;IACZ,WAAW,CAAA,GAAA,gKAAA,CAAA,OAAI,AAAD,EAAE,+HAAA,CAAA,UAAO;IACvB,SAAS;AACX;AAEA,gBAAgB;AAChB,MAAM,eAAe,CAAA,GAAA,gKAAA,CAAA,qBAAkB,AAAD,EAAE;IACtC,WAAW,CAAA,GAAA,gKAAA,CAAA,OAAI,AAAD,EAAE,+HAAA,CAAA,UAAO;IACvB,OAAO,+HAAA,CAAA,QAAK;AACd;AAEA,mBAAmB;AACnB,MAAM,kBAAkB,CAAA,GAAA,6LAAA,CAAA,wBAAqB,AAAD,EAAE;IAC5C,WAAW,CAAA,GAAA,gKAAA,CAAA,OAAI,AAAD,EAAE,+HAAA,CAAA,gBAAa;AAC/B;AAEA,kBAAkB;AAClB,MAAM,aAAa,CAAA,GAAA,kKAAA,CAAA,sBAAmB,AAAD,EAAE,+HAAA,CAAA,6BAA0B;AAEjE,iBAAiB;AACjB,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,qBAAkB,AAAD,EAAE;IACvC,SAAS;IACT,OAAO,+HAAA,CAAA,QAAK;IACZ,WAAW,CAAA,GAAA,gKAAA,CAAA,OAAI,AAAD,EAAE,+HAAA,CAAA,UAAO;AACzB;AAEA,eAAe;AACf,MAAM,eAAe,MAAM,CAAA,GAAA,mLAAA,CAAA,qBAAkB,AAAD,EAAE;IAC5C,QAAQ;IACR,YAAY;QACV,SAAS,iLAAA,CAAA,sBAAmB;QAC5B,SAAS;IACX;IACA,QAAQ;QAAC;KAAI;IACb,SAAS;AACX;AAEA,MAAM,YAAY,CAAA,GAAA,2LAAA,CAAA,sBAAmB,AAAD,EAAE;IACpC,WAAW,CAAA,GAAA,gKAAA,CAAA,OAAI,AAAD,EAAE,+HAAA,CAAA,gBAAa;IAC7B,MAAM;IACN,SAAS;IACT,QAAQ;IACR,OAAO,+HAAA,CAAA,QAAK;IACZ,WAAW;AAKb;AAEA,MAAM,qBAAqB,CAAA,GAAA,gLAAA,CAAA,2BAAwB,AAAD,EAAE;IAClD,SAAS;IACT,QAAQ;IACR,OAAO,+HAAA,CAAA,QAAK;IACZ,kBAAkB,CAAA,GAAA,gKAAA,CAAA,OAAI,AAAD,EAAE,+HAAA,CAAA,gBAAa;AACtC","debugId":null}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///Users/marshabl/Dropbox/CS/typescript_practice/dynamic-paymaster-starter/lib/api/getSignature.ts"],"sourcesContent":["import type { PackedUserOperation } from 'viem/account-abstraction';\nimport type { GetSignatureRequest } from '@/lib/fastlane/types';\n\ninterface GetSignatureResponse {\n  jsonrpc: \"2.0\";\n  id: number;\n  result: string;\n  error?: { code: number; message: string };\n}\n\nexport async function getSignature(\n  packedUserOp: PackedUserOperation,\n  validUntil: number,\n  validAfter: number,\n  paymasterAddress: string,\n  chainId: number\n): Promise<string> {\n  const payload: GetSignatureRequest = {\n    jsonrpc: \"2.0\",\n    id: 1,\n    method: \"backend_getSignature\",\n    params: {\n      userOp: packedUserOp,\n      validUntil,\n      validAfter,\n      paymasterAddress, \n      chainId\n    }\n  };\n\n  const response = await fetch('/api/paymaster', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload, (key, value) => typeof value === 'bigint' ? value.toString() : value)\n  });\n\n  const data: GetSignatureResponse = await response.json();\n  if (data.error) {\n    throw new Error(`Error from backend: ${data.error.message}`);\n  }\n  return data.result;\n} "],"names":[],"mappings":";;;AAUO,eAAe,aACpB,YAAiC,EACjC,UAAkB,EAClB,UAAkB,EAClB,gBAAwB,EACxB,OAAe;IAEf,MAAM,UAA+B;QACnC,SAAS;QACT,IAAI;QACJ,QAAQ;QACR,QAAQ;YACN,QAAQ;YACR;YACA;YACA;YACA;QACF;IACF;IAEA,MAAM,WAAW,MAAM,MAAM,kBAAkB;QAC7C,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC,SAAS,CAAC,KAAK,QAAU,OAAO,UAAU,WAAW,MAAM,QAAQ,KAAK;IAC/F;IAEA,MAAM,OAA6B,MAAM,SAAS,IAAI;IACtD,IAAI,KAAK,KAAK,EAAE;QACd,MAAM,IAAI,MAAM,CAAC,oBAAoB,EAAE,KAAK,KAAK,CAAC,OAAO,EAAE;IAC7D;IACA,OAAO,KAAK,MAAM;AACpB","debugId":null}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///Users/marshabl/Dropbox/CS/typescript_practice/dynamic-paymaster-starter/app/components/Methods.js"],"sourcesContent":["'use client';\nimport { useState, useEffect } from 'react';\nimport { useDynamicContext, useIsLoggedIn } from \"@dynamic-labs/sdk-react-core\";\nimport { isEthereumWallet } from '@dynamic-labs/ethereum'\nimport { userClient, smartAccountClient, shBundler, sponsorClient } from '@/lib/fastlane/user';\nimport { toPackedUserOperation } from 'viem/account-abstraction';\nimport './Methods.css';\nimport { getSignature } from '@/lib/api/getSignature';\nimport { CHAIN_ID, PAYMASTER_ADDRESS } from '@/lib/fastlane/constants';\nexport default function DynamicMethods({ isDarkMode }) {\n  const isLoggedIn = useIsLoggedIn();\n  const { sdkHasLoaded, primaryWallet } = useDynamicContext();\n  const [isLoading, setIsLoading] = useState(true);\n  const [result, setResult] = useState('');\n\n  \n  const safeStringify = (obj) => {\n    const seen = new WeakSet();\n    return JSON.stringify(obj, (key, value) => {\n      if (typeof value === 'object' && value !== null) {\n        if (seen.has(value)) {\n          return '[Circular]';\n        }\n        seen.add(value);\n      }\n      return value;\n    }, 2);\n  };\n\n  useEffect(() => {\n    if (sdkHasLoaded && isLoggedIn && primaryWallet) {\n      setIsLoading(false);\n    } else {\n      setIsLoading(true);\n    }\n  }, [sdkHasLoaded, isLoggedIn, primaryWallet]);\n\n  function clearResult() {\n    setResult('');\n  }\n\n  async function fetchWalletClient() {\n      if(!smartAccountClient) return;\n      setResult(safeStringify(smartAccountClient));\n  }\n\n  async function sendSponsoredTransaction() {\n    if(!smartAccountClient) return;\n    const calls = [\n      {\n        to: userClient.account.address,\n        value: 1000000000000000n,\n      },\n    ];\n    const userOp = await smartAccountClient.prepareUserOperation({\n      account: smartAccountClient.account,\n      calls,\n    });\n\n    const packedUserOp = toPackedUserOperation(userOp);\n    console.log(\"packedUserOp\", packedUserOp);\n    console.log(\"gasFees\", packedUserOp.gasFees);\n    \n    // BACKEND SERVICE: START\n    const currentTime = BigInt(Math.floor(Date.now() / 1000));\n    const validUntil = currentTime + 3600n;\n    const validAfter = 0n;\n\n    const sponsorSignature = await getSignature(packedUserOp, validUntil, validAfter, PAYMASTER_ADDRESS, CHAIN_ID);\n    // BACKEND SERVICE: END\n    \n    const userOpHash = await shBundler.sendUserOperation({\n      account: smartAccountClient.account,\n      calls,\n      // MUST HAVE SAME NONCE AS PREPARED USER OPERATION\n      nonce: userOp.nonce,\n      callGasLimit: userOp.callGasLimit,\n      verificationGasLimit: userOp.verificationGasLimit,\n      preVerificationGas: userOp.preVerificationGas,\n      maxFeePerGas: userOp.maxFeePerGas,\n      maxPriorityFeePerGas: userOp.maxPriorityFeePerGas,\n      paymasterContext: {\n        mode: \"sponsor\",\n        sponsor: sponsorClient.account.address,\n        sponsorSignature,\n        validUntil: validUntil.toString(),\n        validAfter: validAfter.toString()\n      }\n    });\n    \n    const userOpReceipt = await shBundler.waitForUserOperationReceipt({\n      hash: userOpHash,\n    });\n    console.log(\"User Operation Receipt:\", userOpReceipt);\n  }\n\n   return (\n    <>\n      {!isLoading && (\n        <div className=\"dynamic-methods\" data-theme={isDarkMode ? 'dark' : 'light'}>\n          <div className=\"methods-container\">\n            \n            \n    {primaryWallet && isEthereumWallet(primaryWallet) &&\n      <>\n        <button className=\"btn btn-primary\" onClick={fetchWalletClient}>Fetch Wallet Client</button>\n        <button className=\"btn btn-primary\" onClick={sendSponsoredTransaction}>Send Sponsored Transaction</button>    \n      </>\n    }\n\n        </div>\n          {result && (\n            <div className=\"results-container\">\n              <pre className=\"results-text\">{result}</pre>\n            </div>\n          )}\n          {result && (\n            <div className=\"clear-container\">\n              <button className=\"btn btn-primary\" onClick={clearResult}>Clear</button>\n            </div>\n          )}\n        </div>\n      )}\n    </>\n  );\n}"],"names":[],"mappings":";;;;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AACA;;;;;;;AARA;;;;;;;;;AASe,SAAS,eAAe,EAAE,UAAU,EAAE;;IACnD,MAAM,aAAa,CAAA,GAAA,8NAAA,CAAA,gBAAa,AAAD;IAC/B,MAAM,EAAE,YAAY,EAAE,aAAa,EAAE,GAAG,CAAA,GAAA,iPAAA,CAAA,oBAAiB,AAAD;IACxD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAGrC,MAAM,gBAAgB,CAAC;QACrB,MAAM,OAAO,IAAI;QACjB,OAAO,KAAK,SAAS,CAAC,KAAK,CAAC,KAAK;YAC/B,IAAI,OAAO,UAAU,YAAY,UAAU,MAAM;gBAC/C,IAAI,KAAK,GAAG,CAAC,QAAQ;oBACnB,OAAO;gBACT;gBACA,KAAK,GAAG,CAAC;YACX;YACA,OAAO;QACT,GAAG;IACL;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,IAAI,gBAAgB,cAAc,eAAe;gBAC/C,aAAa;YACf,OAAO;gBACL,aAAa;YACf;QACF;mCAAG;QAAC;QAAc;QAAY;KAAc;IAE5C,SAAS;QACP,UAAU;IACZ;IAEA,eAAe;QACX,IAAG,CAAC,0HAAA,CAAA,qBAAkB,EAAE;QACxB,UAAU,cAAc,0HAAA,CAAA,qBAAkB;IAC9C;IAEA,eAAe;QACb,IAAG,CAAC,0HAAA,CAAA,qBAAkB,EAAE;QACxB,MAAM,QAAQ;YACZ;gBACE,IAAI,0HAAA,CAAA,aAAU,CAAC,OAAO,CAAC,OAAO;gBAC9B,OAAO,iBAAiB;YAC1B;SACD;QACD,MAAM,SAAS,MAAM,0HAAA,CAAA,qBAAkB,CAAC,oBAAoB,CAAC;YAC3D,SAAS,0HAAA,CAAA,qBAAkB,CAAC,OAAO;YACnC;QACF;QAEA,MAAM,eAAe,CAAA,GAAA,4MAAA,CAAA,wBAAqB,AAAD,EAAE;QAC3C,QAAQ,GAAG,CAAC,gBAAgB;QAC5B,QAAQ,GAAG,CAAC,WAAW,aAAa,OAAO;QAE3C,yBAAyB;QACzB,MAAM,cAAc,OAAO,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;QACnD,MAAM,aAAa,cAAc,KAAK;QACtC,MAAM,aAAa,EAAE;QAErB,MAAM,mBAAmB,MAAM,CAAA,GAAA,6HAAA,CAAA,eAAY,AAAD,EAAE,cAAc,YAAY,YAAY,+HAAA,CAAA,oBAAiB,EAAE,+HAAA,CAAA,WAAQ;QAC7G,uBAAuB;QAEvB,MAAM,aAAa,MAAM,0HAAA,CAAA,YAAS,CAAC,iBAAiB,CAAC;YACnD,SAAS,0HAAA,CAAA,qBAAkB,CAAC,OAAO;YACnC;YACA,kDAAkD;YAClD,OAAO,OAAO,KAAK;YACnB,cAAc,OAAO,YAAY;YACjC,sBAAsB,OAAO,oBAAoB;YACjD,oBAAoB,OAAO,kBAAkB;YAC7C,cAAc,OAAO,YAAY;YACjC,sBAAsB,OAAO,oBAAoB;YACjD,kBAAkB;gBAChB,MAAM;gBACN,SAAS,0HAAA,CAAA,gBAAa,CAAC,OAAO,CAAC,OAAO;gBACtC;gBACA,YAAY,WAAW,QAAQ;gBAC/B,YAAY,WAAW,QAAQ;YACjC;QACF;QAEA,MAAM,gBAAgB,MAAM,0HAAA,CAAA,YAAS,CAAC,2BAA2B,CAAC;YAChE,MAAM;QACR;QACA,QAAQ,GAAG,CAAC,2BAA2B;IACzC;IAEC,qBACC;kBACG,CAAC,2BACA,6LAAC;YAAI,WAAU;YAAkB,cAAY,aAAa,SAAS;;8BACjE,6LAAC;oBAAI,WAAU;8BAGpB,iBAAiB,CAAA,GAAA,iNAAA,CAAA,mBAAgB,AAAD,EAAE,gCACjC;;0CACE,6LAAC;gCAAO,WAAU;gCAAkB,SAAS;0CAAmB;;;;;;0CAChE,6LAAC;gCAAO,WAAU;gCAAkB,SAAS;0CAA0B;;;;;;;;;;;;;gBAKpE,wBACC,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAI,WAAU;kCAAgB;;;;;;;;;;;gBAGlC,wBACC,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAO,WAAU;wBAAkB,SAAS;kCAAa;;;;;;;;;;;;;;;;;;AAOxE;GApHwB;;QACH,8NAAA,CAAA,gBAAa;QACQ,iPAAA,CAAA,oBAAiB;;;KAFnC","debugId":null}},
    {"offset": {"line": 362, "column": 0}, "map": {"version":3,"sources":["file:///Users/marshabl/Dropbox/CS/typescript_practice/dynamic-paymaster-starter/app/page.tsx"],"sourcesContent":["\n'use client';\n\nimport { DynamicWidget } from \"@/lib/dynamic\";\nimport { useState, useEffect } from 'react';\nimport DynamicMethods from \"@/app/components/Methods\";\nimport './page.css';\n\nconst checkIsDarkSchemePreferred = () => {\n  if (typeof window !== 'undefined') {\n    return window.matchMedia?.('(prefers-color-scheme:dark)')?.matches ?? false;\n  }\n  return false;\n};\n\nexport default function Main() {\n  const [isDarkMode, setIsDarkMode] = useState(checkIsDarkSchemePreferred);\n\n  useEffect(() => {\n    const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    const handleChange = () => setIsDarkMode(checkIsDarkSchemePreferred());\n    \n    darkModeMediaQuery.addEventListener('change', handleChange);\n    return () => darkModeMediaQuery.removeEventListener('change', handleChange);\n  }, []);\n\n  return (\n    <div className={`container ${isDarkMode ? 'dark' : 'light'}`}>\n      <div className=\"header\">\n        <img className=\"logo\" src={isDarkMode ? \"/logo-light.png\" : \"/logo-dark.png\"} alt=\"dynamic\" />\n        <div className=\"header-buttons\">\n          <button className=\"docs-button\" onClick={() => window.open('https://docs.dynamic.xyz', '_blank', 'noopener,noreferrer')}>Docs</button>\n          <button className=\"get-started\" onClick={() => window.open('https://app.dynamic.xyz', '_blank', 'noopener,noreferrer')}>Get started</button>\n        </div>\n      </div>\n      <div className=\"modal\">\n        <DynamicWidget />\n        <DynamicMethods isDarkMode={isDarkMode} />\n      </div>\n      <div className=\"footer\">\n        <div className=\"footer-text\">Made with ❤️ by dynamic</div>\n        <img className=\"footer-image\" src={isDarkMode ? \"/image-dark.png\" : \"/image-light.png\"} alt=\"dynamic\" />\n      </div>\n    </div> \n  );\n}\n"],"names":[],"mappings":";;;;AAGA;AAAA;AACA;AACA;;;;;;;AAJA;;;;;AAOA,MAAM,6BAA6B;IACjC,wCAAmC;QACjC,OAAO,OAAO,UAAU,GAAG,gCAAgC,WAAW;IACxE;;AAEF;AAEe,SAAS;;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0BAAE;YACR,MAAM,qBAAqB,OAAO,UAAU,CAAC;YAC7C,MAAM;+CAAe,IAAM,cAAc;;YAEzC,mBAAmB,gBAAgB,CAAC,UAAU;YAC9C;kCAAO,IAAM,mBAAmB,mBAAmB,CAAC,UAAU;;QAChE;yBAAG,EAAE;IAEL,qBACE,6LAAC;QAAI,WAAW,CAAC,UAAU,EAAE,aAAa,SAAS,SAAS;;0BAC1D,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;wBAAO,KAAK,aAAa,oBAAoB;wBAAkB,KAAI;;;;;;kCAClF,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAO,WAAU;gCAAc,SAAS,IAAM,OAAO,IAAI,CAAC,4BAA4B,UAAU;0CAAwB;;;;;;0CACzH,6LAAC;gCAAO,WAAU;gCAAc,SAAS,IAAM,OAAO,IAAI,CAAC,2BAA2B,UAAU;0CAAwB;;;;;;;;;;;;;;;;;;0BAG5H,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,uNAAA,CAAA,gBAAa;;;;;kCACd,6LAAC,+HAAA,CAAA,UAAc;wBAAC,YAAY;;;;;;;;;;;;0BAE9B,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCAAc;;;;;;kCAC7B,6LAAC;wBAAI,WAAU;wBAAe,KAAK,aAAa,oBAAoB;wBAAoB,KAAI;;;;;;;;;;;;;;;;;;AAIpG;GA9BwB;KAAA","debugId":null}}]
}